<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>謎解き検索システム</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <h1>検索システム</h1>
    
    <div class="tab-buttons">
        <button class="tab-btn active" onclick="switchTab('word')">語群検索</button>
        <button class="tab-btn" onclick="switchTab('kanji')">漢字検索</button>
        <button class="tab-btn" onclick="switchTab('gojuon')">五十音表</button>
        <button class="tab-btn" onclick="switchTab('custom')">カスタム表</button>
    </div>

    <!-- 語群検索タブ -->
    <div id="tab-word" class="tab-content active">
        <p class="description">スプレッドシート連動版</p>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="ひらがなorアルファベットを入力" oninput="searchWords()">
            <div class="options">
                <label class="checkbox-label">
                    <input type="checkbox" id="looseMode" onchange="searchWords()">
                    濁音・半濁音・拗音を区別しない
                </label>
            </div>
            <div id="resultCount" class="result-count">データを読み込み中...</div>
        </div>
        <div id="resultArea" class="result-area"></div>
    </div>

    <!-- 漢字検索タブ -->
    <div id="tab-kanji" class="tab-content">
        <p class="description">小学校で習う漢字（1026字）の検索</p>
        <div class="search-box">
            <input type="text" id="kanjiInput" placeholder="部首や漢字を入力（例：言、心）" oninput="searchKanji()">
            <div class="options">
                <label class="checkbox-label">
                    <input type="checkbox" id="useExtendedSearch" onchange="searchKanji()">
                    拡張キーワードも含める
                </label>
            </div>
            <div class="sort-options">
                <span>並び替え:</span>
                <select id="sortOption" onchange="searchKanji()">
                    <option value="grade_asc">学年順 (低→高)</option>
                    <option value="grade_desc">学年順 (高→低)</option>
                    <option value="stroke_asc">画数順 (少→多)</option>
                    <option value="stroke_desc">画数順 (多→少)</option>
                </select>
            </div>
            <div id="kanjiCount" class="result-count">全1026字から検索</div>
        </div>
        <div id="kanjiResultArea" class="result-area kanji-grid"></div>
    </div>

    <!-- ▼▼▼ 五十音表検索タブ ▼▼▼ -->
    <div id="tab-gojuon" class="tab-content">
        <p class="description">
            選択したマスの「形」と同じ動きをする単語を探します
        </p>
        
        <!-- コントロールエリア（五十音・カスタム共通のスタイルを使用） -->
        <div class="gojuon-controls">
            <button class="btn-reset" onclick="resetSelection()">リセット</button>
            
            <div class="gojuon-options">
                <span class="opt-title">使用する辞書:</span>
                <label class="checkbox-label">
                    <input type="checkbox" id="useDictStandard" checked onchange="searchByShape()">
                    一般語
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="useDictPig" onchange="searchByShape()">
                    豚辞書
                </label>
            </div>

            <div class="gojuon-options">
                <span class="opt-title">形状オプション:</span>
                <label class="checkbox-label">
                    <input type="checkbox" id="allowRotation" onchange="searchByShape()">
                    回転OK
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="allowReflection" onchange="searchByShape()">
                    反転OK
                </label>
            </div>
            
            <div id="gojuonSelectDisplay" class="select-display">選択: なし</div>
        </div>

        <div class="gojuon-wrapper">
            <canvas id="lineCanvasGojuon"></canvas>
            <div id="gojuonGrid" class="gojuon-grid"></div>
        </div>

        <div id="txtStatus" class="result-count">辞書ファイルを読み込み中...</div>
        <div id="gojuonResultArea" class="result-area"></div>
    </div>

    <!-- ▼▼▼ カスタム表検索タブ (新規追加) ▼▼▼ -->
    <div id="tab-custom" class="tab-content">
        <p class="description">
            自由に文字を配置して検索できます
        </p>

        <!-- カスタム表作成エリア -->
        <div class="custom-maker">
            <textarea id="customInputText" placeholder="ここに文字を入力してください（例：あいうえおかきくけこ...）"></textarea>
            <div class="custom-settings">
                <label>列数: <input type="number" id="customCols" value="5" min="1" max="20"></label>
                <button class="btn-create" onclick="createCustomTable()">表を作成</button>
            </div>
        </div>
        
        <div class="gojuon-controls">
            <button class="btn-reset" onclick="resetSelection()">リセット</button>
            
            <!-- オプションは共通IDを使わず、クラスで管理するか、ここでは連動させるために同じIDの別要素を置かない工夫が必要。
                 今回はシンプルに、五十音表タブのオプション設定を共用（参照）する形にします。
                 ※画面上に見えているオプションUIを複製する場合はIDを変える必要がありますが、
                 今回は簡略化のため「五十音タブの設定」がそのまま適用される仕様とします。
                 （必要であればカスタムタブにも独自IDでオプションを追加し、JSで分岐させます）
            -->
            <p style="font-size:12px; color:#666;">※辞書や回転設定は「五十音表」タブの設定が適用されます</p>
            
            <div id="customSelectDisplay" class="select-display">選択: なし</div>
        </div>

        <div class="gojuon-wrapper">
            <canvas id="lineCanvasCustom"></canvas>
            <div id="customGrid" class="gojuon-grid custom-grid-style"></div>
        </div>

        <div id="customResultArea" class="result-area"></div>
    </div>

</div>

<!-- 詳細表示モーダル -->
<div id="detailModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <div id="modalBody"></div>
    </div>
</div>

<script src="kanji_data.js"></script>
<script src="script.js"></script>

</body>
</html>
